# Интегрированный редактор диалогов с квестами

## Обзор

Новый интегрированный редактор диалогов с квестами позволяет легко создавать квесты и связывать их с диалогами в одном удобном интерфейсе. Больше не нужно вручную редактировать JSON файлы!

## Как использовать

### 1. Открытие редактора

1. Запустите JsonEditor
2. Откройте ваш файл `game_data.json`
3. Перейдите в меню **Инструменты** → **Интегрированный редактор диалогов с квестами**

### 2. Создание нового квеста

1. В открывшемся редакторе нажмите **"Создать новый квест"**
2. Заполните форму быстрого создания:
   - **ID квеста**: автоматически предлагается следующий доступный ID
   - **Название**: название квеста
   - **Описание**: описание квеста
   - **Квестодатель**: выберите NPC из списка
   - **Тип условия**: выберите тип условия (Посетить локацию, Убить монстров, и т.д.)
   - **Описание условия**: автоматически заполняется в зависимости от типа
   - **ID цели**: ID локации, монстра, предмета или NPC
3. Нажмите **"Создать"**

### 3. Создание диалога

1. Перейдите на вкладку **"Диалог"**
2. Нажмите **"Добавить узел"** для создания нового узла диалога
3. Заполните:
   - **ID узла**: уникальный идентификатор узла
   - **Текст узла**: текст, который будет говорить NPC
4. Добавьте варианты ответов:
   - Нажмите **"Добавить выбор"**
   - Заполните текст ответа
   - Укажите следующий узел диалога
   - При необходимости добавьте действия (StartQuest, CompleteQuest, и т.д.)

### 4. Связывание узлов с квестом

1. Перейдите на вкладку **"Связи с квестом"**
2. Выберите узел диалога из списка
3. Выберите тип узла квеста:
   - **Обычный узел**: обычный диалог без связи с квестом
   - **Предложение квеста**: узел, где NPC предлагает квест
   - **Квест в процессе**: узел, когда квест уже взят, но не выполнен
   - **Готов к завершению**: узел, когда квест выполнен и готов к сдаче
   - **Квест завершен**: узел после завершения квеста
4. Нажмите **"Применить"**

### 5. Автоматические действия

Редактор автоматически:
- Добавляет действие `StartQuest` к первому выбору в узле "Предложение квеста"
- Добавляет действие `CompleteQuest` к первому выбору в узле "Готов к завершению"
- Связывает узлы с квестом в структуре данных
- Обновляет NPC с информацией о квестах для выдачи

### 6. Сохранение

1. Нажмите **"Сохранить"** в нижней части редактора
2. Все изменения автоматически сохраняются в GameData
3. NPC автоматически получает квест в список `QuestsToGive`

## Преимущества

✅ **Простота**: Не нужно редактировать JSON вручную  
✅ **Безопасность**: Автоматическая валидация данных  
✅ **Интеграция**: Квесты и диалоги создаются в одном месте  
✅ **Автоматизация**: Действия и связи настраиваются автоматически  
✅ **Визуальность**: Удобный интерфейс с вкладками  

## Типы условий квестов

- **VisitLocation**: Посетить локацию (ID локации)
- **KillMonsters**: Убить монстров (ID монстра)
- **CollectItems**: Собрать предметы (ID предмета)
- **TalkToNPC**: Поговорить с NPC (ID NPC)

## Типы действий в диалогах

- **None**: Без действия
- **GiveItem**: Дать предмет
- **GiveGold**: Дать золото
- **StartQuest**: Начать квест
- **CompleteQuest**: Завершить квест
- **SetFlag**: Установить флаг
- **StartTrade**: Начать торговлю
- **EndDialogue**: Завершить диалог

## Примеры использования

### Создание простого квеста "Разведка"

1. **Создайте квест**:
   - ID: 5001
   - Название: "Разведка"
   - Описание: "Староста просит осмотреть Северную Поляну"
   - Квестодатель: Староста Федот
   - Условие: VisitLocation, ID цели: 3002 (Северная Поляна)

2. **Создайте диалог**:
   - Узел 1: "quest_5001_offer" - предложение квеста
   - Узел 2: "quest_5001_inprogress" - квест в процессе
   - Узел 3: "quest_5001_readytocomplete" - готов к завершению
   - Узел 4: "quest_5001_completed" - квест завершен

3. **Свяжите узлы**:
   - quest_5001_offer → "Предложение квеста"
   - quest_5001_inprogress → "Квест в процессе"
   - quest_5001_readytocomplete → "Готов к завершению"
   - quest_5001_completed → "Квест завершен"

4. **Сохраните** - все готово!

Теперь квест будет автоматически предлагаться Старостой Федотом и правильно работать в игре!
